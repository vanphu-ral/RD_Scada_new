<div class="p-1">
    <p-table [value]="data" [paginator]="true" [rowsPerPageOptions]="[5,10,20,50]" [rows]="20"
        currentPageReportTemplate="Hiển thị {first} đến {last} trong tổng số {totalRecords} mục"
        [showCurrentPageReport]="true">
        <ng-template pTemplate="header">
            <tr>
                <th>STT</th>
                <th>Serial</th>
                <th>Kết quả</th>
                <th>Thời gian check</th>
                <th>Lệnh SX xuất hiện</th>
                <th>Người check</th>
            </tr>
            <tr>
                <th></th>
                <th></th>
                <th>
                    <p-columnFilter matchMode="equals" [showMenu]="false" field="result">
                        <ng-template pTemplate="filter" let-value let-filter="filterCallback">
                            <p-select [ngModel]="value" (ngModelChange)="filter($event)" [options]="['Hợp lệ', 'Lỗi']" [showClear]="true" [appendTo]="'body'">
                            </p-select>
                        </ng-template>
                    </p-columnFilter>
                </th>
                <th></th>
                <th></th>
                <th></th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-item let-rowIndex="rowIndex">
            <tr>
                <td>{{ rowIndex + 1 }}</td>
                <td>{{ item.serialCheck }}</td>
                <td [ngClass]="item.result === 'Hợp lệ' ? 'text-success' : 'text-danger'">{{ item.result }}</td>
                <td>{{ item.timeCheck }}</td>
                <td>{{ item.wo }}</td>
                <td>{{ item.userName }}</td>
            </tr>
        </ng-template>
    </p-table>
    <div class="d-flex justify-content-end gap-2 mt-4">
        <p-button icon="pi pi-file-excel" label="Export Excel" severity="success" (onClick)="exportExcel()"></p-button>
        <p-button label="Đóng" severity="danger" (onClick)="close()"></p-button>
    </div>
</div>